\section{序論}\label{sec:intro}
\subsection{背景}\label{subsec:background}

インフラ構造物の施工から維持管理の段階では大量の画像が撮影されており，直感的に現況の把握が可能な画像管理方法が模索されている．
構造物の状況を記録・把握するうえで，画像の使用は低コストかつ汎用性が高い方法である．
特に，近年ドローン等の普及に伴い，より多くの視点から画像が取得可能になった. 
しかし，このようにして得られた大量の画像は，必要な情報に対応する画像の参照や，撮影場所の正確な特定，画像間の相互参照に適したデータベースとしては集約されていない．
例えば，施工現場における記録画像の管理は電子小黒板と紐づけた階層的な管理がされている程度\cite{kouji-shashin}である．
そのため，大量の画像を管理している場合であっても，現場での確認作業に近い形で画像を参照しながらの現況把握は困難である．
この点において，大量の画像群を三次元空間上で集約・統合するプラットフォームの構築は，現実に近い形での現況把握に大きく寄与する.
撮影画像と三次元空間が紐づくことで，画像と撮影位置の対応が明確になり，迅速な位置特定や近隣画像の相互参照が可能になる.
また，大量の画像情報を一つの三次元空間表現に集約し，未撮影視点での画像取得が可能になれば，仮想空間上で現場を自由に移動するような，より直感的な現況把握や分析が実現できる．\par

しかしながら，画像を用いた三次元復元に関する一般的な手法は，現実に即した見た目の再現に課題がある．
具体的には，(1)軽量な三次元モデルで複雑な形状を再現できない，(2)視点によって見え方が異なる部分の復元に失敗する，という二つの課題がある.
ここでいう三次元モデルとは，点群やポリゴン，後述するガウシアン等により，三次元空間を表現するモデルを指す．
撮影画像群からの三次元復元では，Structure from Motion(以下，SfM)とMulti View Stereo(以下，MVS)という二つの手法を組み合わせることが一般的である.
撮影画像群を入力として，SfMで疎な三次元点群とカメラ標定要素を推定し，MVSで密な三次元モデルを作成する.
しかし，一般的なMVSは，ポリゴンや点群など離散的な空間表現を用いるため，細部の複雑な形状を表現するには高い計算コストとデータ容量を要する．
また，反射や透過等の原因で視線方向により見え方が異なる部分では，SfMの段階で特徴点同士の対応付けが困難となり，復元が失敗する場合がある．\par

一方で，複雑な形状や視点による見え方の違いを再現できる，フォトリアルな三次元復元手法として，Differentiable Renderingという手法が近年注目を集めている.
Differentiable Renderingとは，レンダリング画像と入力画像の差分に基づき，三次元モデルを調整できるレンダリング手法の総称である\cite{differentiable_rendering}．
レンダリング画像と入力画像を直接比較し三次元モデルのパラメタを最適化するため，現実に近いレンダリング画像が再現できる．
また，三次元モデル作成時に入力画像間の対応関係を必要としないため，視線方向による見え方の違いに対しロバストである.
Differentiable Renderingの中でも，2023年に発表された3D Gaussian Splatting(以下，3DGS)\cite{3dgs}は，視覚的再現性の高さとレンダリングの速さから，現在コンピュータービジョンの分野で盛んに研究されている.
3DGSとは，色を持った三次元の異方性ガウシアンの集合により空間を表現する手法である（図入れる!!!）．
各ガウシアンは，三次元位置に加え，共分散行列，不透明度，色を構成要素に持つ．
異方性を持つガウシアンを用いることで，ポリゴンや点群と比べて少ないパラメタで複雑かつ連続的な表現を実現している（図\ref{fig:green-house}）．
また，ガウシアンの持つ色を視線方向の関数とすることで，視線方向による見え方の違いを表現可能である．\par

\begin{figure}[h]
    \centering
    \includegraphics[width=0.5\linewidth]{images/chapter1/3dgs_green_house.png}
    \caption[3DGSによる三次元空間表現の例]{3DGSによる三次元空間表現の例（\cite{green-house}より）．植物の葉のような細部の複雑な形状表現や，水面の反射を再現している．}
    \label{fig:green-house}
\end{figure}

しかし，入力画像にピンボケや手ブレといった不鮮明な画像が含まれている場合の三次元復元は，3DGSであっても依然としてチャレンジングな課題である.
その原因の一つは，ガウシアンが入力画像のノイズに過剰に適合するからである.
これは，入力画像の不鮮明な部分を再現するようにガウシアンが最適化され，レンダリング時にピンボケやブレを含んだ画像を生成するためである．
ピンボケへの対応を試みている3DGS手法\cite{Deblurring3dgs}\cite{BAGS}もあり，これらの手法では入力画像を再現するピンボケの表現が深層学習ベースで学習されている．
そのため，ガウシアンがピンボケに過剰に適合し，カメラからの深度に応じてピンボケの大きさが変化するという幾何学的条件が満たされず失敗する場合がある.
上記の要因に加え，3DGSの入力となるカメラ標定要素が不正確であることも，正確な三次元復元ができない一因である．
3DGSではSfMで推定されたカメラ標定要素を入力として用いる.
そのため，特徴点の抽出が困難である不鮮明な画像では，SfMによる推定カメラ標定要素が不正確となり，3DGSによる三次元モデルの構成要素に大きな誤差が生じる場合がある.
ピンボケ画像に適用可能な既存手法は，カメラ標定要素が正しい場合を前提としており，カメラ標定要素が不正確な場合にそれらを修正する手法は管見の限りではない.\par

そこで，本研究では， 幾何学的条件に基づくピンボケ表現を導入するとともに，不正確なカメラ標定要素の修正を行う3DGS手法を提案する.
ピンボケ画像を含んだ画像群からロバストにフォトリアルな三次元復元が可能になることで，撮影された画像情報を無駄なく利用した三次元モデル作成と，より効率的な現況把握が可能になると期待される.\par

\subsection{目的}\label{subsec:objective}

本研究では，「ピンボケ画像群に対しロバストな3D Gaussian Splatting手法の構築」を目的とする．
具体的には，カメラの原理に基づくピンボケ表現の導入と不正確なカメラ標定要素の修正を伴う三次元モデルの最適化を行う.
ピンボケの大きさはカメラから被写体までの深度に依存し一意に定まる.
そこで本研究では，ガウシアンの深度に基づく正則化項を損失に追加することで，幾何学的条件に忠実なピンボケ表現を導入する.
また，SfMの出力するカメラ標定要素が不正確な場合を想定し，カメラ標定要素の修正を逐次的に行う3DGS手法を構築する.\par

本研究では上記手法の有効性を検証するため，既存のデータセットに加え，カメラ標定要素の評価が可能なデータセットを作成し，評価を行う.
既存のデータセットでは，ピンボケ画像を用いてSfMを行った結果がカメラ標定要素として使用されており，カメラ標定要素の真値は得られない.
そこで，本研究では複数の焦点距離画像が取得可能なライトフィールドカメラで撮影を行い，同一のカメラ標定要素を持つピンボケ画像と全焦点画像のペアを用いてデータセットを作成する.
ピンボケ画像のカメラ標定要素修正に対して，対応する全焦点画像のカメラ標定要素を真値とすることで，カメラ標定要素修正の有効性を評価する.

\subsection{本論文の構成}\label{subsec:construction}

本論文は，本章を含めて全5章で構成される．

本章では，本研究の背景・目的を述べた．

第2章では，既往研究の整理を行う．

第3章では，本研究の提案手法を紹介する．

第4章では，提案手法を適用した結果とその精度について議論する．

第5章では，本論文の結論を示した後，今後の発展可能性を示す．